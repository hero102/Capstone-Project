<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Organization Admin Dashboard</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.1);
      overflow: hidden;
    }

    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .header h1 {
      font-size: 28px;
      margin-bottom: 5px;
    }

    .header p {
      opacity: 0.9;
      font-size: 16px;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .btn-logout {
      background: rgba(255,255,255,0.2);
      color: white;
      border: 2px solid white;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s;
    }

    .btn-logout:hover {
      background: white;
      color: #667eea;
    }

    .alert {
      padding: 15px 30px;
      margin: 20px 30px;
      border-radius: 8px;
      font-weight: 500;
    }

    .alert-success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .alert-error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    .alert-info {
      background: #d1ecf1;
      color: #0c5460;
      border: 1px solid #bee5eb;
    }

    .tabs {
      display: flex;
      background: #f8f9fa;
      padding: 0 30px;
      border-bottom: 2px solid #dee2e6;
      overflow-x: auto;
    }

    .tabs button {
      background: none;
      border: none;
      padding: 15px 25px;
      cursor: pointer;
      font-size: 15px;
      font-weight: 600;
      color: #6c757d;
      transition: all 0.3s;
      border-bottom: 3px solid transparent;
      white-space: nowrap;
    }

    .tabs button:hover {
      color: #667eea;
    }

    .tabs button.active {
      color: #667eea;
      border-bottom-color: #667eea;
    }

    .tab-content {
      padding: 30px;
    }

    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      color: white;
    }

    .spinner {
      width: 50px;
      height: 50px;
      border: 5px solid rgba(255,255,255,0.3);
      border-top-color: white;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: white;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      border-left: 5px solid;
    }

    .stat-purple { border-left-color: #9b59b6; }
    .stat-blue { border-left-color: #3498db; }
    .stat-orange { border-left-color: #f39c12; }
    .stat-green { border-left-color: #27ae60; }

    .stat-card h3 {
      font-size: 36px;
      margin-bottom: 10px;
      color: #2c3e50;
    }

    .stat-card p {
      color: #7f8c8d;
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 5px;
    }

    .stat-card small {
      color: #95a5a6;
      font-size: 13px;
    }

    .quick-actions {
      background: #f8f9fa;
      padding: 25px;
      border-radius: 12px;
      margin-bottom: 30px;
    }

    .quick-actions h3 {
      margin-bottom: 20px;
      color: #2c3e50;
    }

    .quick-actions button {
      margin-right: 10px;
      margin-bottom: 10px;
    }

    .account-summary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 30px;
      border-radius: 12px;
      color: white;
    }

    .account-summary h3 {
      margin-bottom: 20px;
      font-size: 24px;
    }

    .account-card {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: rgba(255,255,255,0.15);
      padding: 25px;
      border-radius: 10px;
      backdrop-filter: blur(10px);
    }

    .account-info p {
      margin-bottom: 10px;
      font-size: 15px;
    }

    .account-balance {
      text-align: right;
    }

    .account-balance p {
      font-size: 14px;
      opacity: 0.9;
      margin-bottom: 5px;
    }

    .account-balance h2 {
      font-size: 42px;
      margin-bottom: 10px;
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
    }

    .section-header h2 {
      color: #2c3e50;
      font-size: 26px;
    }

    .form-card {
      background: #f8f9fa;
      padding: 30px;
      border-radius: 12px;
      margin-bottom: 30px;
      border: 2px solid #e9ecef;
    }

    .form-card h3 {
      margin-bottom: 25px;
      color: #2c3e50;
      font-size: 22px;
    }

    .form-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      margin-bottom: 20px;
    }

    .form-group label {
      margin-bottom: 8px;
      color: #495057;
      font-weight: 600;
      font-size: 14px;
    }

    .form-group input,
    .form-group select,
    .form-group textarea {
      padding: 12px 15px;
      border: 2px solid #dee2e6;
      border-radius: 8px;
      font-size: 14px;
      transition: all 0.3s;
      font-family: inherit;
    }

    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102,126,234,0.1);
    }

    .form-group small {
      margin-top: 5px;
      color: #6c757d;
      font-size: 12px;
    }

    .btn-primary, .btn-secondary, .btn-success, .btn-danger, .btn-warning {
      padding: 12px 25px;
      border: none;
      border-radius: 8px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .btn-primary:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 5px 20px rgba(102,126,234,0.4);
    }

    .btn-secondary {
      background: #6c757d;
      color: white;
    }

    .btn-secondary:hover {
      background: #5a6268;
    }

    .btn-success {
      background: #28a745;
      color: white;
    }

    .btn-success:hover {
      background: #218838;
    }

    .btn-danger {
      background: #dc3545;
      color: white;
    }

    .btn-danger:hover {
      background: #c82333;
    }

    .btn-warning {
      background: #ffc107;
      color: #212529;
    }

    .btn-warning:hover {
      background: #e0a800;
    }

    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .section {
      margin-bottom: 30px;
    }

    .section h3 {
      color: #2c3e50;
      margin-bottom: 20px;
      font-size: 22px;
    }

    .card {
      background: white;
      border: 2px solid #dee2e6;
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 15px;
      transition: all 0.3s;
    }

    .card:hover {
      box-shadow: 0 5px 20px rgba(0,0,0,0.1);
      transform: translateY(-2px);
    }

    .card-warning {
      border-left: 5px solid #ffc107;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      padding-bottom: 15px;
      border-bottom: 1px solid #e9ecef;
    }

    .card-header h4 {
      color: #2c3e50;
      font-size: 18px;
    }

    .card-body p {
      margin-bottom: 8px;
      color: #495057;
      font-size: 14px;
    }

    .card-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid #e9ecef;
    }

    .card-actions button {
      padding: 8px 16px;
      font-size: 13px;
    }

    .badge {
      display: inline-block;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
    }

    .badge-success {
      background: #d4edda;
      color: #155724;
    }

    .badge-warning {
      background: #fff3cd;
      color: #856404;
    }

    .badge-danger {
      background: #f8d7da;
      color: #721c24;
    }

    .badge-info {
      background: #d1ecf1;
      color: #0c5460;
    }

    .table-container {
      overflow-x: auto;
      border-radius: 10px;
      border: 2px solid #dee2e6;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
    }

    thead {
      background: #f8f9fa;
    }

    th {
      padding: 15px;
      text-align: left;
      font-weight: 600;
      color: #495057;
      border-bottom: 2px solid #dee2e6;
      font-size: 14px;
    }

    td {
      padding: 15px;
      border-bottom: 1px solid #e9ecef;
      color: #495057;
      font-size: 14px;
    }

    tbody tr:hover {
      background: #f8f9fa;
    }

    .vendor-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: 20px;
    }

    @media (max-width: 768px) {
      .header {
        flex-direction: column;
        text-align: center;
        gap: 20px;
      }

      .tabs {
        overflow-x: scroll;
      }

      .stats-grid {
        grid-template-columns: 1fr;
      }

      .account-card {
        flex-direction: column;
        text-align: center;
      }

      .account-info {
        margin-bottom: 20px;
      }

      .form-row {
        grid-template-columns: 1fr;
      }

      .vendor-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>

<div *ngIf="orgAdmin" class="container">
  <!-- Header -->
  <div class="header">
    <div class="header-left">
      <h1>üè¢ Organization Admin Dashboard</h1>
      <p>{{orgAdmin.organizationName}}</p>
    </div>
    <div class="header-right">
      <span>Welcome, {{orgAdmin.name}}</span>
      <button (click)="logout()" class="btn-logout">Logout</button>
    </div>
  </div>

  <!-- Message Alert -->
  <div *ngIf="message" [class]="'alert alert-' + messageType">
    {{message}}
  </div>

  <!-- Navigation Tabs -->
  <div class="tabs">
    <button [class.active]="activeTab === 'dashboard'" (click)="setActiveTab('dashboard')">
      üìä Dashboard
    </button>
    <button [class.active]="activeTab === 'employees'" (click)="setActiveTab('employees')">
      üë• Employees
    </button>
    <button [class.active]="activeTab === 'vendors'" (click)="setActiveTab('vendors')">
      üè™ Vendors
    </button>
    <button [class.active]="activeTab === 'payments'" (click)="setActiveTab('payments')">
      üí≥ Vendor Payments
    </button>
    <button [class.active]="activeTab === 'salaries'" (click)="setActiveTab('salaries')">
      üí∞ Salaries
    </button>
    <button [class.active]="activeTab === 'account'" (click)="setActiveTab('account')">
      üè¶ Corporate Account
    </button>
  </div>

  <!-- Loading Spinner -->
  <div *ngIf="loading" class="loading-overlay">
    <div class="spinner"></div>
    <p>Processing...</p>
  </div>

  <!-- Dashboard Tab -->
  <div *ngIf="activeTab === 'dashboard'" class="tab-content">
    <h2>Dashboard Overview</h2>
    
    <div class="stats-grid">
      <div class="stat-card stat-purple">
        <h3>{{dashboardStats.totalEmployees}}</h3>
        <p>Total Employees</p>
        <small>{{dashboardStats.activeEmployees}} Active</small>
      </div>
      <div class="stat-card stat-blue">
        <h3>{{dashboardStats.totalVendors}}</h3>
        <p>Total Vendors</p>
        <small>{{dashboardStats.activeVendors}} Active</small>
      </div>
      <div class="stat-card stat-orange">
        <h3>{{dashboardStats.pendingEmployees}}</h3>
        <p>Pending Approvals</p>
        <small>Employee Requests</small>
      </div>
      <div class="stat-card stat-green">
        <h3>‚Çπ{{dashboardStats.corporateBalance | number:'1.2-2'}}</h3>
        <p>Corporate Balance</p>
        <small>Available Funds</small>
      </div>
    </div>

    <div class="quick-actions">
      <h3>Quick Actions</h3>
      <button (click)="setActiveTab('employees'); showEmployeeForm = true" class="btn-primary">
        ‚ûï Add Employee
      </button>
      <button (click)="setActiveTab('vendors'); showVendorForm = true" class="btn-primary">
        ‚ûï Add Vendor
      </button>
      <button (click)="setActiveTab('payments')" class="btn-secondary">
        üí≥ Make Payment
      </button>
      <button (click)="requestSalaryDisbursement()" class="btn-success">
        üí∞ Request Salary Disbursement
      </button>
    </div>

    <!-- Corporate Account Summary -->
    <div *ngIf="corporateAccount" class="account-summary">
      <h3>üíº Corporate Account Summary</h3>
      <div class="account-card">
        <div class="account-info">
          <p><strong>Bank:</strong> {{corporateAccount.bankName}}</p>
          <p><strong>Account Number:</strong> {{corporateAccount.accountNumber}}</p>
          <p><strong>IFSC Code:</strong> {{corporateAccount.ifscCode}}</p>
          <p><strong>Branch:</strong> {{corporateAccount.branch}}</p>
        </div>
        <div class="account-balance">
          <p>Available Balance</p>
          <h2>‚Çπ{{corporateAccount.balance | number:'1.2-2'}}</h2>
          <span [class]="'badge badge-' + (corporateAccount.status === 'ACTIVE' ? 'success' : 'warning')">
            {{corporateAccount.status}}
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- Employees Tab -->
  <div *ngIf="activeTab === 'employees'" class="tab-content">
    <div class="section-header">
      <h2>Employee Management</h2>
      <button *ngIf="!showEmployeeForm" (click)="showEmployeeForm = true" class="btn-primary">
        ‚ûï Add Employee
      </button>
      <button *ngIf="showEmployeeForm" (click)="resetEmployeeForm()" class="btn-secondary">
        ‚ùå Cancel
      </button>
    </div>

    <!-- Add Employee Form -->
    <div *ngIf="showEmployeeForm" class="form-card">
      <h3>Add New Employee</h3>
      <form>
        <div class="form-row">
          <div class="form-group">
            <label>Full Name *</label>
            <input type="text" [(ngModel)]="employeeForm.name" name="name" 
                   placeholder="Enter full name" required>
          </div>
          <div class="form-group">
            <label>Email *</label>
            <input type="email" [(ngModel)]="employeeForm.email" name="email" 
                   placeholder="employee@example.com" required>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Phone Number</label>
            <input type="tel" [(ngModel)]="employeeForm.phoneNumber" name="phone" 
                   placeholder="+91 XXXXXXXXXX">
          </div>
          <div class="form-group">
            <label>Designation *</label>
            <input type="text" [(ngModel)]="employeeForm.designation" name="designation" 
                   placeholder="e.g. Software Engineer" required>
          </div>
        </div>

        <div class="form-group">
          <label>Department *</label>
          <input type="text" [(ngModel)]="employeeForm.department" name="department" 
                 placeholder="e.g. IT, HR, Finance" required>
        </div>

        <div class="form-group">
          <label>ID Document *</label>
          <input type="file" (change)="onFileSelect($event, 'employee')" 
                 accept=".pdf,.jpg,.jpeg,.png" required>
          <small>Upload Aadhar/PAN/Passport (PDF, JPG, PNG - Max 2MB)</small>
        </div>

        <button type="button" (click)="addEmployee()" class="btn-primary" [disabled]="loading">
          {{loading ? 'Adding...' : '‚úÖ Add Employee'}}
        </button>
      </form>
    </div>

    <!-- Pending Employees -->
    <div *ngIf="pendingEmployees.length > 0" class="section">
      <h3>‚è≥ Pending Approval ({{pendingEmployees.length}})</h3>
      <div *ngFor="let emp of pendingEmployees" class="card card-warning">
        <div class="card-header">
          <h4>{{emp.name}}</h4>
          <span class="badge badge-warning">{{emp.status}}</span>
        </div>
        <div class="card-body">
          <p><strong>Email:</strong> {{emp.email}}</p>
          <p><strong>Designation:</strong> {{emp.designation}}</p>
          <p><strong>Department:</strong> {{emp.department}}</p>
          <p><small>Awaiting Bank Admin approval</small></p>
        </div>
      </div>
    </div>

    <!-- All Employees -->
    <div class="section">
      <h3>üìã All Employees ({{employees.length}})</h3>
      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>Name</th>
              <th>Email</th>
              <th>Designation</th>
              <th>Department</th>
              <th>Status</th>
              <th>Joining Date</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let emp of employees">
              <td>{{emp.name}}</td>
              <td>{{emp.email}}</td>
              <td>{{emp.designation}}</td>
              <td>{{emp.department}}</td>
              <td>
                <span [class]="'badge badge-' + (emp.status === 'ACTIVE' ? 'success' : emp.status === 'PENDING_APPROVAL' ? 'warning' : 'danger')">
                  {{emp.status}}
                </span>
              </td>
              <td>{{emp.joiningDate | date:'mediumDate'}}</td>
              <td>
                <button *ngIf="emp.status === 'ACTIVE'" (click)="openSalaryForm(emp)" class="btn-primary" style="padding: 6px 12px; font-size: 13px;">
                  üí∞ Salary
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Vendors Tab -->
  <div *ngIf="activeTab === 'vendors'" class="tab-content">
    <div class="section-header">
      <h2>Vendor Management</h2>
      <button *ngIf="!showVendorForm" (click)="showVendorForm = true" class="btn-primary">
        ‚ûï Add Vendor
      </button>
      <button *ngIf="showVendorForm" (click)="resetVendorForm()" class="btn-secondary">
        ‚ùå Cancel
      </button>
    </div>

    <!-- Add Vendor Form -->
    <div *ngIf="showVendorForm" class="form-card">
      <h3>Add New Vendor</h3>
      <form>
        <div class="form-row">
          <div class="form-group">
            <label>Vendor Name *</label>
            <input type="text" [(ngModel)]="vendorForm.vendorName" name="vendorName" 
                   placeholder="Enter vendor name" required>
          </div>
          <div class="form-group">
            <label>Email *</label>
            <input type="email" [(ngModel)]="vendorForm.email" name="email" 
                   placeholder="vendor@example.com" required>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Phone Number</label>
            <input type="tel" [(ngModel)]="vendorForm.phoneNumber" name="phone" 
                   placeholder="+91 XXXXXXXXXX">
          </div>
          <div class="form-group">
            <label>GST Number</label>
            <input type="text" [(ngModel)]="vendorForm.gstNumber" name="gst" 
                   placeholder="22AAAAA0000A1Z5">
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>PAN Number</label>
            <input type="text" [(ngModel)]="vendorForm.panNumber" name="pan" 
                   placeholder="ABCDE1234F">
          </div>
          <div class="form-group">
            <label>Bank Name *</label>
            <input type="text" [(ngModel)]="vendorForm.bankName" name="bankName" 
                   placeholder="e.g. HDFC Bank" required>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Account Number *</label>
            <input type="text" [(ngModel)]="vendorForm.accountNumber" name="accountNumber" 
                   placeholder="Enter account number" required>
          </div>
          <div class="form-group">
            <label>IFSC Code *</label>
            <input type="text" [(ngModel)]="vendorForm.ifscCode" name="ifscCode" 
                   placeholder="e.g. HDFC0001234" required>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Branch</label>
            <input type="text" [(ngModel)]="vendorForm.branch" name="branch" 
                   placeholder="Branch name">
          </div>
        </div>

        <div class="form-group">
          <label>Address</label>
          <textarea [(ngModel)]="vendorForm.address" name="address" 
                    placeholder="Enter complete address" rows="3"></textarea>
        </div>

        <button type="button" (click)="addVendor()" class="btn-primary" [disabled]="loading">
          {{loading ? 'Adding...' : '‚úÖ Add Vendor'}}
        </button>
      </form>
    </div>

    <!-- Vendors List -->
    <div class="section">
      <h3>üè™ All Vendors ({{vendors.length}})</h3>
      <div class="vendor-grid">
        <div *ngFor="let vendor of vendors" class="card">
          <div class="card-header">
            <h4>{{vendor.vendorName}}</h4>
            <span [class]="'badge badge-' + (vendor.status === 'ACTIVE' ? 'success' : 'danger')">
              {{vendor.status}}
            </span>
          </div>
          <div class="card-body">
            <p><strong>Email:</strong> {{vendor.email}}</p>
            <p><strong>Phone:</strong> {{vendor.phoneNumber || 'N/A'}}</p>
            <p><strong>Bank:</strong> {{vendor.bankName}}</p>
            <p><strong>Account:</strong> {{vendor.accountNumber}}</p>
            <p><strong>IFSC:</strong> {{vendor.ifscCode}}</p>
            <p *ngIf="vendor.gstNumber"><strong>GST:</strong> {{vendor.gstNumber}}</p>
          </div>
          <div class="card-actions">
            <button *ngIf="vendor.status === 'ACTIVE'" (click)="openPaymentForm(vendor)" class="btn-primary">
              üí≥ Pay
            </button>
            <button *ngIf="vendor.status === 'ACTIVE'" (click)="deactivateVendor(vendor.vendorId)" class="btn-warning">
              ‚è∏Ô∏è Deactivate
            </button>
            <button *ngIf="vendor.status === 'INACTIVE'" (click)="reactivateVendor(vendor.vendorId)" class="btn-success">
              ‚ñ∂Ô∏è Reactivate
            </button>
            <button (click)="deleteVendor(vendor.vendorId)" class="btn-danger">
              üóëÔ∏è Delete
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Vendor Payments Tab -->
  <div *ngIf="activeTab === 'payments'" class="tab-content">
    <div class="section-header">
      <h2>Vendor Payments</h2>
    </div>

    <!-- Payment Form -->
    <div *ngIf="showPaymentForm && selectedVendor" class="form-card">
      <h3>Make Payment to {{selectedVendor.vendorName}}</h3>
      <form>
        <div class="form-row">
          <div class="form-group">
            <label>Amount *</label>
            <input type="number" [(ngModel)]="paymentForm.amount" name="amount" 
                   placeholder="Enter amount" min="0" step="0.01" required>
          </div>
          <div class="form-group">
            <label>Payment Mode *</label>
            <select [(ngModel)]="paymentForm.paymentMode" name="paymentMode" required>
              <option value="BANK_TRANSFER">Bank Transfer</option>
              <option value="UPI">UPI</option>
              <option value="CHEQUE">Cheque</option>
              <option value="CASH">Cash</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label>Payment Purpose *</label>
          <textarea [(ngModel)]="paymentForm.paymentPurpose" name="purpose" 
                    placeholder="Enter payment purpose/description" rows="3" required></textarea>
        </div>

        <div style="display: flex; gap: 10px;">
          <button type="button" (click)="requestVendorPayment()" class="btn-primary" [disabled]="loading">
            {{loading ? 'Processing...' : '‚úÖ Request Payment'}}
          </button>
          <button type="button" (click)="resetPaymentForm()" class="btn-secondary">
            ‚ùå Cancel
          </button>
        </div>
      </form>
    </div>

    <!-- Pending Payments -->
    <div *ngIf="pendingPayments.length > 0" class="section">
      <h3>‚è≥ Pending Payments ({{pendingPayments.length}})</h3>
      <div *ngFor="let payment of pendingPayments" class="card card-warning">
        <div class="card-header">
          <h4>{{payment.vendorName}}</h4>
          <span class="badge badge-warning">{{payment.status}}</span>
        </div>
        <div class="card-body">
          <p><strong>Amount:</strong> ‚Çπ{{payment.amount | number:'1.2-2'}}</p>
          <p><strong>Purpose:</strong> {{payment.paymentPurpose}}</p>
          <p><strong>Payment Mode:</strong> {{payment.paymentMode}}</p>
          <p><strong>Requested:</strong> {{payment.requestedAt | date:'medium'}}</p>
          <p><small>Awaiting Bank Admin approval</small></p>
        </div>
      </div>
    </div>

    <!-- Approved Payments -->
    <div class="section">
      <h3>‚úÖ All Payments ({{vendorPayments.length}})</h3>
      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>Vendor</th>
              <th>Amount</th>
              <th>Purpose</th>
              <th>Mode</th>
              <th>Status</th>
              <th>Transaction ID</th>
              <th>Requested</th>
              <th>Approved</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let payment of vendorPayments">
              <td>{{payment.vendorName}}</td>
              <td>‚Çπ{{payment.amount | number:'1.2-2'}}</td>
              <td>{{payment.paymentPurpose}}</td>
              <td>{{payment.paymentMode}}</td>
              <td>
                <span [class]="'badge badge-' + (payment.status === 'COMPLETED' ? 'success' : payment.status === 'PENDING' ? 'warning' : 'danger')">
                  {{payment.status}}
                </span>
              </td>
              <td>{{payment.transactionId || 'N/A'}}</td>
              <td>{{payment.requestedAt | date:'short'}}</td>
              <td>{{payment.approvedAt ? (payment.approvedAt | date:'short') : 'N/A'}}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Salaries Tab -->
  <div *ngIf="activeTab === 'salaries'" class="tab-content">
    <div class="section-header">
      <h2>Salary Management</h2>
    </div>

    <!-- Create Salary Form -->
    <div *ngIf="showSalaryForm && selectedEmployee" class="form-card">
      <h3>Create Salary for {{selectedEmployee.name}}</h3>
      <form>
        <div class="form-row">
          <div class="form-group">
            <label>Basic Salary *</label>
            <input type="number" [(ngModel)]="salaryForm.basicSalary" name="basicSalary" 
                   placeholder="Enter basic salary" min="0" step="0.01" required>
          </div>
          <div class="form-group">
            <label>HRA (House Rent Allowance)</label>
            <input type="number" [(ngModel)]="salaryForm.hra" name="hra" 
                   placeholder="Enter HRA" min="0" step="0.01">
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Other Allowances</label>
            <input type="number" [(ngModel)]="salaryForm.allowances" name="allowances" 
                   placeholder="Enter allowances" min="0" step="0.01">
          </div>
          <div class="form-group">
            <label>Deductions</label>
            <input type="number" [(ngModel)]="salaryForm.deductions" name="deductions" 
                   placeholder="Enter deductions" min="0" step="0.01">
          </div>
        </div>

        <div class="form-group">
          <label>Net Salary (Calculated)</label>
          <input type="text" 
                 [value]="(salaryForm.basicSalary + salaryForm.hra + salaryForm.allowances - salaryForm.deductions) | number:'1.2-2'" 
                 readonly style="background: #e9ecef; font-weight: bold; font-size: 16px;">
        </div>

        <div style="display: flex; gap: 10px;">
          <button type="button" (click)="createSalary()" class="btn-primary" [disabled]="loading">
            {{loading ? 'Creating...' : '‚úÖ Create Salary'}}
          </button>
          <button type="button" (click)="resetSalaryForm()" class="btn-secondary">
            ‚ùå Cancel
          </button>
        </div>
      </form>
    </div>

    <!-- Generate Monthly Salaries -->
    <div class="form-card">
      <h3>üìÖ Generate Monthly Salaries</h3>
      <p style="margin-bottom: 15px; color: #6c757d;">Generate salaries for all active employees for a specific month</p>
      <div style="display: flex; gap: 15px; align-items: flex-end;">
        <div class="form-group" style="flex: 1; margin-bottom: 0;">
          <label>Select Month *</label>
          <input type="month" [(ngModel)]="generateSalaryMonth" name="generateMonth" required>
        </div>
        <button type="button" (click)="generateMonthlySalaries()" class="btn-success" [disabled]="loading">
          {{loading ? 'Generating...' : 'üîÑ Generate Salaries'}}
        </button>
      </div>
    </div>

    <!-- Disbursement Requests -->
    <div *ngIf="disbursementRequests.length > 0" class="section">
      <h3>üí∏ Disbursement Requests ({{disbursementRequests.length}})</h3>
      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>Month</th>
              <th>Total Amount</th>
              <th>Status</th>
              <th>Requested</th>
              <th>Approved</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let req of disbursementRequests">
              <td>{{req.month | date:'MMMM yyyy'}}</td>
              <td>‚Çπ{{req.totalAmount | number:'1.2-2'}}</td>
              <td>
                <span [class]="'badge badge-' + (req.status === 'APPROVED' ? 'success' : req.status === 'PENDING' ? 'warning' : 'danger')">
                  {{req.status}}
                </span>
              </td>
              <td>{{req.requestedAt | date:'short'}}</td>
              <td>{{req.approvedAt ? (req.approvedAt | date:'short') : 'N/A'}}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- All Salaries -->
    <div class="section">
      <h3>üí∞ All Salaries ({{salaries.length}})</h3>
      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>Employee</th>
              <th>Month</th>
              <th>Basic Salary</th>
              <th>HRA</th>
              <th>Allowances</th>
              <th>Deductions</th>
              <th>Net Salary</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let salary of salaries">
              <td>{{salary.employeeName}}</td>
              <td>{{salary.salaryMonth | date:'MMMM yyyy'}}</td>
              <td>‚Çπ{{salary.basicSalary | number:'1.2-2'}}</td>
              <td>‚Çπ{{salary.hra | number:'1.2-2'}}</td>
              <td>‚Çπ{{salary.allowances | number:'1.2-2'}}</td>
              <td>‚Çπ{{salary.deductions | number:'1.2-2'}}</td>
              <td><strong>‚Çπ{{salary.netSalary | number:'1.2-2'}}</strong></td>
              <td>
                <span [class]="'badge badge-' + (salary.disbursed ? 'success' : 'warning')">
                  {{salary.disbursed ? 'DISBURSED' : 'PENDING'}}
                </span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Corporate Account Tab -->
  <div *ngIf="activeTab === 'account'" class="tab-content">
    <div class="section-header">
      <h2>Corporate Account Details</h2>
    </div>

    <div *ngIf="corporateAccount" class="account-summary" style="margin: 0;">
      <h3>üíº Account Information</h3>
      <div class="account-card">
        <div class="account-info">
          <p><strong>Bank Name:</strong> {{corporateAccount.bankName}}</p>
          <p><strong>Account Number:</strong> {{corporateAccount.accountNumber}}</p>
          <p><strong>IFSC Code:</strong> {{corporateAccount.ifscCode}}</p>
          <p><strong>Branch:</strong> {{corporateAccount.branch}}</p>
          <p><strong>Account Status:</strong> 
            <span [class]="'badge badge-' + (corporateAccount.status === 'ACTIVE' ? 'success' : 'warning')">
              {{corporateAccount.status}}
            </span>
          </p>
        </div>
        <div class="account-balance">
          <p>Available Balance</p>
          <h2>‚Çπ{{corporateAccount.balance | number:'1.2-2'}}</h2>
        </div>
      </div>
    </div>

    <div *ngIf="!corporateAccount" class="form-card">
      <h3>No Corporate Account Found</h3>
      <p style="color: #6c757d;">Your organization's corporate account details are not available. Please contact your Bank Admin.</p>
    </div>

    <!-- Account Activity Summary -->
    <div class="section" style="margin-top: 30px;">
      <h3>üìä Account Activity Summary</h3>
      <div class="stats-grid">
        <div class="stat-card stat-blue">
          <h3>{{vendorPayments.length}}</h3>
          <p>Total Payments</p>
          <small>All vendor payments</small>
        </div>
        <div class="stat-card stat-green">
          <h3>{{approvedPayments.length}}</h3>
          <p>Completed Payments</p>
          <small>Successfully processed</small>
        </div>
        <div class="stat-card stat-orange">
          <h3>{{pendingPayments.length}}</h3>
          <p>Pending Payments</p>
          <small>Awaiting approval</small>
        </div>
        <div class="stat-card stat-purple">
          <h3>{{disbursementRequests.length}}</h3>
          <p>Disbursement Requests</p>
          <small>Salary disbursements</small>
        </div>
      </div>
    </div>
  </div>

</div>

<!-- No Data Message -->
<div *ngIf="!orgAdmin" style="text-align: center; padding: 50px; color: white;">
  <h2>‚ö†Ô∏è Access Denied</h2>
  <p>Please log in to access the Organization Admin Dashboard</p>
 <button (click)="logout()">Logout</button>

</div>

</body>
</html>